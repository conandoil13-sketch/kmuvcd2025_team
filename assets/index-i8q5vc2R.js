(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();const Q={w:2560,h:1440},pt=40,O=160,tt="A–Z, 0–9, 공백, . , ! ? _ - @ # ( ) [ ] / & * % + : ;",ut="/kmuvcd2025_team/assets/MyFont.otf",V={A:"glyphs/a.png",B:"glyphs/b.png",C:"glyphs/c.png",D:"glyphs/d.png",E:"glyphs/e.png",F:"glyphs/f.png",G:"glyphs/g.png",H:"glyphs/h.png",I:"glyphs/i.png",J:"glyphs/j.png",K:"glyphs/k.png",L:"glyphs/l.png",M:"glyphs/m.png",N:"glyphs/n.png",O:"glyphs/o.png",P:"glyphs/p.png",Q:"glyphs/q.png",R:"glyphs/r.png",S:"glyphs/s.png",T:"glyphs/t.png",U:"glyphs/u.png",V:"glyphs/v.png",W:"glyphs/w.png",X:"glyphs/x.png",Y:"glyphs/y.png",Z:"glyphs/z.png",0:"glyphs/0.png",1:"glyphs/1.png",2:"glyphs/2.png",3:"glyphs/3.png",4:"glyphs/4.png",5:"glyphs/5.png",6:"glyphs/6.png",7:"glyphs/7.png",8:"glyphs/8.png",9:"glyphs/9.png","!":"glyphs/exclaim.png","?":"glyphs/question.png",".":"glyphs/period.png",",":"glyphs/comma.png","-":"glyphs/hyphen.png",_:"glyphs/underscore.png","@":"glyphs/at.png","#":"glyphs/hash.png","&":"glyphs/ampersand.png","*":"glyphs/asterisk.png","/":"glyphs/slash.png","(":"glyphs/paren.png",")":"glyphs/paren.png","[":"glyphs/bracket-square.png","]":"glyphs/bracket-square.png"},G=/^[A-Za-z0-9\s.,!?_\-@#()\/\[\]&*%+:;]$/,et=[],S=t=>document.querySelector(t),l=S("#textInput"),N=S("#limitInput"),gt=S("#trackingInput"),mt=S("#leadingInput"),R=S("#output"),ft=S("#charCount"),ht=S("#charLimit"),yt=S("#linkedCount"),xt=S("#unsupportedCount"),nt=S("#supportedList"),vt=S("#clearBtn"),ot=S("#printBtn"),z=S("#fontSizeInput"),at=S("#fontSizeLabel"),T=document.getElementById("driverPreviewToggle"),J=document.getElementById("previewScaleInput"),it=document.getElementById("previewScaleLabel"),j=document.getElementById("previewScaleBox");let rt=null;function A(t){let e=document.getElementById("typoToast");e||(e=document.createElement("div"),e.id="typoToast",e.style.cssText=`
      position:fixed;left:50%;bottom:28px;transform:translateX(-50%);
      padding:10px 14px;border-radius:10px;background:rgba(20,20,20,.92);
      color:#f5f5f5;font:13px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial;
      border:1px solid #2a2a2a;box-shadow:0 6px 24px rgba(0,0,0,.35);
      opacity:0;pointer-events:none;transition:opacity .18s ease;z-index:9999;
      white-space:pre-wrap;text-align:center;max-width:min(90vw,680px);`,document.body.appendChild(e)),e.textContent=t,requestAnimationFrame(()=>{e.style.opacity="1"}),clearTimeout(rt),rt=setTimeout(()=>{e.style.opacity="0"},1400)}let M=pt,K=!1,Y=1,_=!1;function st(t){var a,i,n;const e=!!t;_=e,N&&(a=N.closest(".field"))!=null&&a.style&&(N.closest(".field").style.display=e?"":"none"),T&&(i=T.closest(".field"))!=null&&i.style&&(T.closest(".field").style.display=e?"":"none"),j&&(j.style.display=e?"":"none"),(n=X.updateVisibility)==null||n.call(X)}let U=null,bt=null,lt=!1;async function Et(t,e="font/otf"){const a=new Uint8Array(t);let i="";for(let r=0;r<a.length;r++)i+=String.fromCharCode(a[r]);const n=btoa(i);return`data:${e};base64,${n}`}async function B(){return U||(U=(async()=>{const t=await fetch(ut,{cache:"force-cache"});if(!t.ok)throw new Error("MyFont.otf 로드 실패: "+t.status);const e=await t.arrayBuffer();if(bt=await Et(e,"font/otf"),!lt){const a=new FontFace("MyFont",e);await a.load(),(document.fonts||{}).add(a),lt=!0}try{await document.fonts.ready}catch{}await new Promise(a=>requestAnimationFrame(()=>requestAnimationFrame(a)))})().catch(t=>{throw U=null,t}),U)}function St(){if(st(!1),l.maxLength=M,ht.textContent=M,Ct(),l.addEventListener("input",e=>$(e.target.value)),N.addEventListener("change",It),gt.addEventListener("input",$t),mt.addEventListener("input",At),vt.addEventListener("click",()=>{l.value="",$("")}),ot&&ot.addEventListener("click",Ut),l.addEventListener("beforeinput",e=>{if(typeof e.data=="string"&&e.data.length===1){if((l.selectionStart!=null&&l.selectionEnd!=null?l.value.length-(l.selectionEnd-l.selectionStart)+1:l.value.length+1)>M){e.preventDefault(),A(`최대 ${M}자까지 입력할 수 있어요.`);return}G.test(e.data)||(e.preventDefault(),A(`허용된 문자만 입력할 수 있어요.
`+tt))}}),l.addEventListener("paste",e=>{e.preventDefault();const a=e.clipboardData||window.clipboardData,i=a&&a.getData("text")||"";let n="";for(const d of i)G.test(d)&&(n+=d);const r=l.selectionStart??l.value.length,m=l.selectionEnd??l.value.length,p=l.value.length-(m-r),f=Math.max(0,M-p),c=n.slice(0,f);c.length&&(l.setRangeText(c,r,m,"end"),l.dispatchEvent(new Event("input",{bubbles:!0}))),n.length!==i.length?A(`허용된 문자만 붙여넣을 수 있어요.
`+tt):c.length||A(`최대 ${M}자까지 입력할 수 있어요.`)}),T&&T.addEventListener("change",async()=>{K=T.checked,j.style.display=K?"":"none",await $(l.value)}),J&&J.addEventListener("input",()=>{const e=Math.max(50,Math.min(300,parseInt(J.value||"100",10)));Y=e/100,it&&(it.textContent=e+"%");const a=R.querySelector("canvas.preview");a&&(a.style.transform=`scale(${Y})`)}),z){const e=parseInt(localStorage.getItem("fontSizePx")||String(O),10);z.value=Number.isFinite(e)?e:O,ct(),z.addEventListener("input",ct)}else document.documentElement.style.setProperty("--fontSizePx",O);const t=document.getElementById("printOSBtn");t&&t.addEventListener("click",async()=>{try{const e=((l==null?void 0:l.value)||"").trim();if(!e){alert("인쇄할 텍스트가 없습니다.");return}const a=getComputedStyle(document.documentElement),i=parseInt(a.getPropertyValue("--fontSizePx"))||160,n=parseFloat(a.getPropertyValue("--leading"))||1;await B();const r=await Z(e,{fontFamily:"MyFont",fontSizePx:i,lineHeight:n,maxWidthPx:576,marginX:8,marginY:8,threshold:190});await _t(r,{pageWidthMM:80,marginMM:0})}catch(e){console.error(e),alert("미리보기 생성 중 오류: "+((e==null?void 0:e.message)||e))}}),window.addEventListener("keydown",e=>{if((e.ctrlKey||e.metaKey)&&e.key==="."){e.preventDefault();const i=(T==null?void 0:T.closest(".field"))||j||null,n=i&&getComputedStyle(i).display==="none";st(n),A(`관리자 모드 ${n?"ON":"OFF"}`)}}),dt(),window.addEventListener("resize",dt),(async()=>{try{await B()}catch(e){console.warn(e)}$(l.value)})()}document.addEventListener("DOMContentLoaded",St);function Ct(){nt.innerHTML="",Object.keys(V).sort().forEach(e=>{const a=document.createElement("li");a.textContent=e+" → "+V[e],nt.appendChild(a)})}function Lt(t){ft.textContent=t.length,R.innerHTML="";let e=0,a=0;for(const i of t){const n=i.toUpperCase(),r=G.test(i);if(V[n]){const p=document.createElement("a");p.href="#",p.className="char",p.textContent=i,p.setAttribute("role","button"),p.setAttribute("aria-label",`${i} 인쇄`),p.addEventListener("click",f=>{f.preventDefault(),Tt(n)}),R.appendChild(p),e++}else{const p=document.createElement("span");p.className="char"+(r||i===" "?"":" unsupported"),p.textContent=i===" "?" ":i,R.appendChild(p),!r&&i!==" "&&a++}}yt.textContent=e,xt.textContent=a}async function kt(t){const e=getComputedStyle(document.documentElement),a=parseInt(e.getPropertyValue("--fontSizePx"))||160,i=parseFloat(e.getPropertyValue("--leading"))||1;await B();const n=await Z(String(t||""),{fontFamily:"MyFont",fontSizePx:a,lineHeight:i,maxWidthPx:576,marginX:8,marginY:8,threshold:190});R.innerHTML="",n.className="preview",n.style.transformOrigin="top left",n.style.transform=`scale(${Y})`,n.style.imageRendering="pixelated",R.appendChild(n),ft.textContent=(t||"").length,yt.textContent=0,xt.textContent=0}async function $(t){return K?kt(t):Lt(t)}function Ft(){let t=document.getElementById("printFrame");return t||(t=document.createElement("iframe"),t.id="printFrame",t.style.cssText="position:absolute;left:-9999px;width:0;height:0;border:0;",document.body.appendChild(t)),t}function Mt(t){const e=t.split("?")[0].split("#")[0].split(".").pop().toLowerCase(),a=Ft(),i=()=>{try{const n=a.contentWindow;setTimeout(()=>{n.focus(),n.print()},80)}catch(n){alert("인쇄 미리보기 호출 실패: "+n.message)}};if(e==="pdf")a.onload=i,a.src=t;else if(["png","jpg","jpeg","gif","webp"].includes(e)){const n=`<!doctype html><html><head><meta charset="utf-8">
<style>@page{size:80mm auto;margin:0}html,body{margin:0;padding:0}img{display:block;width:72mm;margin:6mm 4mm}</style>
</head><body><img src="${t}" alt=""></body></html>`;a.onload=i,a.src="about:blank",setTimeout(()=>{a.srcdoc=n},0)}else e==="txt"?fetch(t).then(n=>n.text()).then(n=>{const r=`<!doctype html><html><head><meta charset="utf-8">
<style>@page{size:80mm auto;margin:0}html,body{margin:0;padding:0}
@font-face{font-family:"MyFont";src:url(${JSON.stringify(ut)}) format("opentype");}
pre{font-family:"MyFont",system-ui,sans-serif;font-size:14pt;line-height:1.25;white-space:pre-wrap;word-break:break-word;width:72mm;margin:6mm 4mm;color:#000}
</style></head><body><pre>${Pt(n)}</pre></body></html>`;a.onload=i,a.src="about:blank",setTimeout(()=>{a.srcdoc=r},0)}).catch(n=>alert("텍스트 로드 실패: "+n.message)):alert("지원하지 않는 인쇄 형식: "+e)}function Tt(t){const e=V[t];if(!e){A(`인쇄 파일 없음: ${t}`);return}Mt(e)}function Pt(t){return t.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e])}function It(){const t=parseInt(N.value,10);M=Number.isFinite(t)?Math.max(1,Math.min(200,t)):pt,l.maxLength=M,ht.textContent=M,l.value.length>M&&(l.value=l.value.slice(0,M),$(l.value))}function $t(){document.documentElement.style.setProperty("--tracking",gt.value)}function At(){const t=Math.max(50,Math.min(300,parseInt(mt.value||"100",10)));document.documentElement.style.setProperty("--leading",(t/100).toString()),$(l.value)}function ct(){const t=z?parseInt(z.value||String(O),10):O,e=Math.max(24,Math.min(300,Number.isFinite(t)?t:O));document.documentElement.style.setProperty("--fontSizePx",e),at&&(at.textContent=e+"px");try{localStorage.setItem("fontSizePx",String(e))}catch{}$(l.value)}function dt(){const t=window.innerWidth,e=window.innerHeight,a=t/Q.w,i=(e-64)/Q.h,n=Math.min(a,i);document.documentElement.style.setProperty("--scale",n.toString())}function Ot(t,e=255){const a=t.width,i=t.height,r=t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,a,i).data;let m=i,p=a,f=-1,c=-1;for(let h=0;h<i;h++)for(let x=0;x<a;x++){const k=(h*a+x)*4;r[k]!==e&&(x<p&&(p=x),x>f&&(f=x),h<m&&(m=h),h>c&&(c=h))}if(f<0)return t;const d=Math.max(1,f-p+1),b=Math.max(1,c-m+1),y=document.createElement("canvas");return y.width=d,y.height=b,y.getContext("2d").drawImage(t,p,m,d,b,0,0,d,b),y}async function Z(t,{fontFamily:e="MyFont",fontSizePx:a=160,lineHeight:i=1,maxWidthPx:n=576,marginX:r=8,marginY:m=8,threshold:p=190}={}){const f=Math.max(1,window.devicePixelRatio||1);await B();const c=document.createElement("canvas"),d=c.getContext("2d",{willReadFrequently:!0}),b=getComputedStyle(document.documentElement),y=parseFloat(b.getPropertyValue("--tracking"))||0,h=a*y/1e3,x=`${a*f}px "${e}", system-ui, sans-serif`;d.font=x;const k=String(t??"").split(/(\s+)/),P=[],q=n-r*2,W=g=>{if(!g)return 0;const E=d.measureText(g).width/f,w=Math.max(0,g.length-1)*h;return E+w};let o="";for(let g=0;g<k.length;g++){const E=o+k[g];W(E)>q&&o?(P.push(o),o=k[g].trimStart()):o=E}o&&P.push(o);const s=a*i,u=Math.ceil(n*f),F=Math.ceil((m*2+s*P.length)*f);c.width=u,c.height=F,d.fillStyle="#fff",d.fillRect(0,0,u,F),d.textBaseline="alphabetic",d.fillStyle="#000",d.font=x;let v=m*f+a*f;const D=r*f;for(const g of P){let E=D;for(let w=0;w<g.length;w++){const I=g[w];d.fillText(I,E,v);const H=d.measureText(I).width+h*f;E+=H}v+=s*f}const L=d.getImageData(0,0,c.width,c.height),C=L.data;for(let g=0;g<C.length;g+=4){const E=C[g],w=C[g+1],I=C[g+2],wt=.299*E+.587*w+.114*I<p?0:255;C[g]=C[g+1]=C[g+2]=wt,C[g+3]=255}return d.putImageData(L,0,0),Ot(c)}function Rt(t){const e=t.width,a=t.height,i=Math.ceil(e/8),n=new Uint8Array([29,118,48,0,i&255,i>>8&255,a&255,a>>8&255]),m=t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,e,a).data,p=new Uint8Array(i*a);let f=0;for(let c=0;c<a;c++)for(let d=0;d<i;d++){let b=0;for(let y=0;y<8;y++){const h=d*8+y;let x=0;if(h<e){const k=(c*e+h)*4;x=m[k]===0?1:0}b|=x<<7-y}p[f++]=b}return{header:n,body:p}}async function Bt(t){var b;if(!("usb"in navigator))throw new Error("이 브라우저는 WebUSB를 지원하지 않습니다. 데스크톱 Chrome + HTTPS를 사용해주세요.");const e=[{classCode:7},{classCode:255}],a=et.length?et:e,i=await navigator.usb.requestDevice({filters:a});await i.open(),i.configuration==null&&await i.selectConfiguration(1);let n=null,r=null,m=0;for(const y of i.configuration.interfaces){for(const h of y.alternates){const x=(b=h.endpoints)==null?void 0:b.find(k=>k.direction==="out");if(x){n=y.interfaceNumber,r=x.endpointNumber,m=h.alternateSetting??0;break}}if(n!=null)break}if(n==null||r==null)throw new Error("OUT 엔드포인트를 찾지 못했습니다.");await i.claimInterface(n);try{await i.selectAlternateInterface(n,m)}catch{}const p=27,f=29;await i.transferOut(r,new Uint8Array([p,64]));const{header:c,body:d}=Rt(t);await i.transferOut(r,c),await i.transferOut(r,d),await i.transferOut(r,new Uint8Array([10,10]));try{await i.transferOut(r,new Uint8Array([f,86,0]))}catch{}}async function Dt(t){const e=getComputedStyle(document.documentElement),a=parseInt(e.getPropertyValue("--fontSizePx"))||160,i=parseFloat(e.getPropertyValue("--leading"))||1;await B();const n=await Z(t,{fontFamily:"MyFont",fontSizePx:a,lineHeight:i,maxWidthPx:560,marginX:8,marginY:8,threshold:190});await Bt(n)}async function Ut(){try{const t=((l==null?void 0:l.value)||"").trim();if(!t){alert("인쇄할 텍스트가 없습니다.");return}await Dt(t),alert("래스터 전송 완료!")}catch(t){console.error(t),alert("프린터 전송 중 문제 발생: "+((t==null?void 0:t.message)||t))}}async function _t(t,{pageWidthMM:e=80,marginMM:a=0,autoRemoveDelay:i=2e3}={}){const n=Math.max(1,window.devicePixelRatio||1),r=96/25.4,m=t.width/(n*r),p=t.height/(n*r);await B();const f=bt,c=document.createElement("iframe");c.setAttribute("aria-hidden","true"),c.style.cssText="position:fixed;right:0;bottom:0;width:0;height:0;border:0;opacity:0;pointer-events:none;",document.body.appendChild(c);const d=t.toDataURL("image/png"),b=`<!doctype html><html><head><meta charset="utf-8"><title>Print</title>
<style>
@page{size:${e}mm auto;margin:${a}mm}
html,body{margin:0;padding:0;background:#fff}
@font-face{font-family:"MyFont";src:url(${JSON.stringify(f)}) format("opentype");font-weight:normal;font-style:normal;}
img{display:block;width:${m}mm;height:${p}mm;image-rendering:-webkit-optimize-contrast}
@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact}}
</style></head>
<body>
<img id="pp" alt="">
<script>(function(){
 const img=document.getElementById('pp');
 img.onload=function(){setTimeout(function(){window.focus();window.print();},20);};
 img.src=${JSON.stringify(d)};
 window.onafterprint=function(){try{parent.postMessage({__fromPrintFrame:true},'*');}catch(e){}};
})();<\/script>
</body></html>`;c.srcdoc=b;const y=h=>{h&&h.data&&h.data.__fromPrintFrame&&(window.removeEventListener("message",y),setTimeout(()=>{try{c.remove()}catch{}},0))};window.addEventListener("message",y),setTimeout(()=>{try{c.remove()}catch{}},i)}const X=(()=>{const t={entries:[],max:100,panel:null,badge:null,open:!1};function e(){i(),n(),window.addEventListener("error",p,!0),window.addEventListener("unhandledrejection",f,!0);const o=console.error.bind(console);console.error=(...s)=>{c({type:"console",message:b(s)}),o(...s)},a()}function a(){const o=typeof _<"u"?_:!1;t.badge&&(t.badge.style.display=o?"":"none"),!o&&t.panel&&(t.panel.style.display="none")}function i(){if(t.badge)return;const o=document.createElement("button");o.id="bugBadge",o.textContent="BUG",o.title="버그 패널 열기/닫기",o.style.cssText=`
      position:fixed; top:10px; right:10px; z-index:99999;
      padding:6px 10px; border-radius:8px; border:1px solid #333;
      background:#ffdad6; color:#111; font:12px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
      cursor:pointer; box-shadow:0 4px 14px rgba(0,0,0,.18); display:none;
    `,o.addEventListener("click",r),document.body.appendChild(o),t.badge=o,m()}function n(){if(t.panel)return;const o=document.createElement("div");o.id="bugPanel",o.style.cssText=`
      position:fixed; inset:auto 10px 10px auto; top:44px; width:min(560px, 90vw); height:min(60vh, 560px);
      background:#101114; color:#e8e8e8; border:1px solid #2f2f2f; border-radius:12px; z-index:99999;
      box-shadow:0 18px 60px rgba(0,0,0,.35); display:none; overflow:hidden;
      font:12px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial;
    `,o.innerHTML=`
      <div style="display:flex;align-items:center;gap:8px;padding:8px 10px;border-bottom:1px solid #2a2a2a;background:#15161a;">
        <strong style="font-size:12px;">Bug Report</strong>
        <span id="bugCnt" style="opacity:.7"></span>
        <div style="margin-left:auto;display:flex;gap:6px;">
          <button id="bugExport" style="padding:4px 8px;border:1px solid #3a3a3a;background:#222;border-radius:6px;color:#eee;cursor:pointer">Export JSON</button>
          <button id="bugCopy"   style="padding:4px 8px;border:1px solid #3a3a3a;background:#222;border-radius:6px;color:#eee;cursor:pointer">Copy</button>
          <button id="bugClear"  style="padding:4px 8px;border:1px solid #3a3a3a;background:#222;border-radius:6px;color:#eee;cursor:pointer">Clear</button>
          <button id="bugClose"  style="padding:4px 8px;border:1px solid #3a3a3a;background:#222;border-radius:6px;color:#eee;cursor:pointer">×</button>
        </div>
      </div>
      <div id="bugList" style="height: calc(100% - 38px); overflow:auto; padding:8px 10px;"></div>
    `,document.body.appendChild(o),o.querySelector("#bugClose").addEventListener("click",r),o.querySelector("#bugClear").addEventListener("click",()=>{t.entries=[],d(),m()}),o.querySelector("#bugCopy").addEventListener("click",()=>P(JSON.stringify(q(),null,2))),o.querySelector("#bugExport").addEventListener("click",W),t.panel=o}function r(){t.open=!t.open,t.panel&&(t.panel.style.display=t.open?"":"none"),t.open&&d()}function m(){if(!t.badge)return;const o=t.entries.length;t.badge.textContent=o?`BUG (${o})`:"BUG"}function p(o){c({type:"error",message:o.message||"Error",file:o.filename||null,line:o.lineno||null,col:o.colno||null,stack:o.error&&o.error.stack?String(o.error.stack):null})}function f(o){const s=o.reason;c({type:"promise",message:s&&s.message?s.message:b([s]),file:null,line:null,col:null,stack:s&&s.stack?String(s.stack):null})}function c(o){o.ts=new Date().toISOString(),t.entries.push(o),t.entries.length>t.max&&t.entries.shift(),m(),t.open&&d()}function d(){var u,F;const o=(u=t.panel)==null?void 0:u.querySelector("#bugList"),s=(F=t.panel)==null?void 0:F.querySelector("#bugCnt");o&&(o.innerHTML="",s&&(s.textContent=`${t.entries.length} errors`),t.entries.slice().reverse().forEach((v,D)=>{const L=document.createElement("div");L.style.cssText="border:1px solid #2a2a2a;border-radius:10px;padding:8px 10px;margin:8px 0;background:#13151a;";const C=document.createElement("div");C.innerHTML=`
        <div style="display:flex;gap:8px;align-items:center;">
          <span style="display:inline-block;padding:2px 6px;border-radius:6px;background:#2b2f3a;color:#cbd5ff;">${v.type}</span>
          <code style="white-space:pre-wrap">${y(v.message||"")}</code>
        </div>
        <div style="opacity:.7;margin-top:4px">
          <code>${y(v.file||"")}</code>${v.line!=null?`:${v.line}`:""}${v.col!=null?`:${v.col}`:""} • <time>${v.ts}</time>
        </div>
      `,L.appendChild(C);const g=document.createElement("div");g.style.cssText="display:flex;gap:6px;margin-top:6px;flex-wrap:wrap";const E=h("Stack",()=>x(v.stack||"(no stack)")),w=h("Code frame",()=>k(v).then(H=>x(H||"(unavailable)"))),I=h("Copy entry",()=>P(JSON.stringify(v,null,2)));g.append(E,w,I),L.appendChild(g),o.appendChild(L)}))}function b(o){try{return o.map(s=>typeof s=="string"?s:JSON.stringify(s)).join(" ")}catch{return String(o)}}function y(o){return String(o).replace(/[&<>"']/g,s=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[s])}function h(o,s){const u=document.createElement("button");return u.textContent=o,u.style.cssText="padding:4px 8px;border:1px solid #3a3a3a;background:#1f2128;border-radius:6px;color:#eee;cursor:pointer",u.addEventListener("click",s),u}function x(o){const s=document.createElement("div");s.style.cssText=`
      position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:100000; display:flex; align-items:center; justify-content:center; padding:20px;
    `;const u=document.createElement("div");u.style.cssText="max-width:min(90vw,1000px); max-height:min(80vh,800px); background:#0f1116; color:#eee; border:1px solid #2b2b2b; border-radius:12px; overflow:auto;",u.innerHTML=`<pre style="margin:0;padding:16px 18px;white-space:pre-wrap;font:12px/1.45 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;">${y(o||"")}</pre>`,s.addEventListener("click",F=>{F.target===s&&s.remove()}),s.appendChild(u),document.body.appendChild(s)}async function k(o,s=6){try{if(!o.file)return null;const u=new URL(o.file,location.href);if(u.origin!==location.origin)return"Cross-origin 소스 — 코드 프레임 불가";const F=await fetch(u.href,{cache:"no-cache"});if(!F.ok)return`소스 로드 실패: ${F.status}`;const D=(await F.text()).split(/\r?\n/),L=Math.max(1,(o.line||1)|0),C=Math.max(1,L-s),g=Math.min(D.length,L+s);let E=`${u.pathname}:${L}${o.col?`:${o.col}`:""}

`;for(let w=C;w<=g;w++)E+=`${w===L?"▶":" "} ${String(w).padStart(String(g).length," ")} | ${D[w-1]}
`;return E}catch(u){return`코드 프레임 생성 실패: ${(u==null?void 0:u.message)||u}`}}function P(o){var s;(s=navigator.clipboard)==null||s.writeText(o).then(()=>{}).catch(()=>{const u=document.createElement("textarea");u.value=o,document.body.appendChild(u),u.select();try{document.execCommand("copy")}finally{u.remove()}})}function q(){return{url:location.href,ua:navigator.userAgent,ts:new Date().toISOString(),admin:!!(typeof _<"u"&&_),entries:t.entries}}function W(){const o=new Blob([JSON.stringify(q(),null,2)],{type:"application/json"}),s=document.createElement("a");s.href=URL.createObjectURL(o),s.download=`bug-report-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,s.click(),setTimeout(()=>URL.revokeObjectURL(s.href),2e3)}return document.addEventListener("DOMContentLoaded",e),{init:e,updateVisibility:a,addEntry:c}})();
